# 邮件发送问题排查指南

## 当前问题分析

根据后端日志显示，邮件测试请求已经到达服务器，但没有看到详细的发送结果。这可能是以下几个原因：

### 1. QQ邮箱配置问题

**推荐配置（选择其一）：**

#### 方案一：使用465端口 + SSL
```
SMTP主机: smtp.qq.com
SMTP端口: 465
使用SSL/TLS: ✓ 开启
SMTP用户名: 你的QQ邮箱@qq.com
SMTP密码: 16位授权码
```

#### 方案二：使用587端口 + STARTTLS
```
SMTP主机: smtp.qq.com
SMTP端口: 587
使用SSL/TLS: ✗ 关闭（系统会自动使用STARTTLS）
SMTP用户名: 你的QQ邮箱@qq.com
SMTP密码: 16位授权码
```

### 2. 授权码检查

1. 登录QQ邮箱网页版
2. 设置 → 账户 → POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务
3. 确认已开启"IMAP/SMTP服务"
4. 重新生成授权码（如果当前的不工作）

### 3. 网络连接检查

#### Windows系统检查SMTP连接：
```cmd
# 检查465端口连接
telnet smtp.qq.com 465

# 检查587端口连接
telnet smtp.qq.com 587
```

如果连接失败，可能是：
- 防火墙阻止了连接
- 网络服务商限制了SMTP端口
- 需要使用代理

### 4. 常见错误和解决方案

#### 错误：Authentication failed
**解决方案：**
- 检查用户名是否为完整邮箱地址
- 确认使用16位授权码，不是QQ密码
- 重新生成授权码

#### 错误：Connection timeout
**解决方案：**
- 检查网络连接
- 尝试不同的端口（465或587）
- 检查防火墙设置

#### 错误：SSL/TLS错误
**解决方案：**
- 465端口：启用SSL
- 587端口：关闭SSL（使用STARTTLS）

### 5. 测试步骤

1. **保存邮件配置**
2. **点击"测试邮件"按钮**
3. **输入测试邮箱地址**
4. **检查以下位置的邮件：**
   - 收件箱
   - 垃圾邮件箱
   - 广告邮件箱

### 6. 调试方法

#### 查看后端日志：
```bash
# 在backend目录下执行
tail -f logs/app.log | grep -i "邮件\|smtp\|email"
```

#### 检查详细错误信息：
后端日志会显示具体的SMTP错误信息，包括：
- 连接状态
- 认证结果
- 发送状态

### 7. 替代方案

如果QQ邮箱仍然无法工作，可以尝试：

#### 163邮箱：
```
SMTP主机: smtp.163.com
SMTP端口: 465 (SSL) 或 25 (非加密)
需要开启SMTP服务并获取授权码
```

#### Gmail（需要科学上网）：
```
SMTP主机: smtp.gmail.com
SMTP端口: 587 (TLS) 或 465 (SSL)
需要开启"不够安全的应用访问权限"或使用应用专用密码
```

### 8. 联系支持

如果问题仍然存在，请提供：
1. 完整的邮件配置（隐藏密码）
2. 后端错误日志
3. 网络连接测试结果
4. 使用的操作系统和网络环境

---

**重要提醒：**
- 授权码不是QQ密码
- 定期更换授权码以确保安全
- 检查垃圾邮件箱
- 某些企业网络可能限制SMTP连接